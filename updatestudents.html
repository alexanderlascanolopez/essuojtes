<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>ESSU OJT EVALUATION SYSTEM</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/animate.css/animate.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: Green - v4.9.0
  * Template URL: https://bootstrapmade.com/green-free-one-page-bootstrap-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Top Bar ======= -->
  <section id="topbar" class="d-flex align-items-center">
    <div class="container d-flex justify-content-center justify-content-md-between">
      <div class="contact-info d-flex align-items-center">
        <i class="bi bi-envelope-fill"></i><a href="mailto:contact@example.com">https://essu.edu.ph/</a>
        <i class="bi bi-phone-fill phone-icon"></i> Brgy. 10, Can-Avid, Philippines, 6806
      </div>
      <div class="social-links d-none d-md-block">
        <a href="#" class="twitter"><i class="bi bi-twitter"></i></a>
        <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
        <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
        <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></i></a>
      </div>
    </div>
  </section>

  <!-- ======= Header ======= -->
  <header id="header" class="d-flex align-items-center">
    <div class="container d-flex align-items-center">

      <h1 class="logo me-auto"><a href="admindashboard.html"><img src="images/logo.png" class="user-image" alt="User Image" width="150%" >

</a></h1>

      <!-- Uncomment below if you prefer to use an image logo -->
      <!-- <a href="index.html" class="logo me-auto"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->

      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto " href="admindashboard.html">Home</a></li>
        
          <li><a class="nav-link scrollto" href="createevaluator.html">Create Evaluator</a></li>
             <li class="dropdown active"><a ><span>Students</span> <i class="bi bi-chevron-down"></i></a>
            <ul>
           
             
              <li><a href="registerstudents.html">Register</a></li>
              <li><a href="ojtenrolment.html">OJT Enrollment</a></li>
          
            </ul>
          </li>
           <li><a class="nav-link scrollto" href="evalresults.html">Evaluation Results</a></li>
            <li class="dropdown"><a ><span>Reports</span> <i class="bi bi-chevron-down"></i></a>
                <ul>
           
             
              <li><a href="students.html">Students</a></li>
              <li><a href="ojt.html">On-the-Job Trainees</a></li>
              <li><a href="evaluationreports.html">Evaluations</a></li>
       
            </ul>
            </li>

              <li class="dropdown"><a ><span>Accounts</span> <i class="bi bi-chevron-down"></i></a>
                <ul>
           
             
              <li><a href="updateprofile.html">Update Profile</a></li>
              <li><a href="newaccount.html">New Account</a></li>
       
       
            </ul>
            </li>
          <li><a class="getstarted scrollto" href="adminlogin.html">Logout</a></li>
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav><!-- .navbar -->

    </div>
  </header><!-- End Header -->




  <main id="main">

<hr>
 <!-- ======= Breadcrumbs ======= -->
    <section id="contact" class="contact">
      <div class="container">

       

        <div class="row">

          <div class="col-lg-5 d-flex align-items-stretch">
          
               

            <form  class="php-email-form">

              <h2>Select Student</h2>

               <div class="form-group col-md-6 mt-3 mt-md-0">
                
                  <input type="text" class="form-control" id="search" placeholder="Enter student name here..">
                </div>
<div style="overflow: scroll ;max-height: 550px; width: 100%;">

                <table id="allrecords"  class="table align-items-center mb-0">


                  <thead class="thead-light">
                    <tr>
                     
                     <th>Select</th>
                    <th hidden="">ID</th>
                     
                    <th scope="col">Student Number</th>
                        <th scope="col">Student Name</th>
                 
                        
                      

                    
                     
                              </tr>
                  </thead>
                      <tbody class="customtable">

                  </tbody>
                  <caption>
                  <div id="e-paginator"></div>
                  </caption>
              </table>

            </div>
<br>

        
             
            </form>
      

          </div>

          <div class="col-lg-7 mt-5 mt-lg-0 d-flex align-items-stretch">


                 <form  role="form" class="php-email-form">

                          <div class="row">
                <div class="form-group col-md-6">
                  <label for="name">Student Number</label>
                  <input type="text" class="form-control" id="sn" readonly >
                </div>
                
              </div>
              <div class="row">
                <div class="form-group col-md-6">
                  <label for="name">First Name</label>
                  <input type="text" name="name" class="form-control" id="fname"  required>
                </div>
                <div class="form-group col-md-6 mt-3 mt-md-0">
                  <label for="name">Middle Name</label>
                  <input type="text" class="form-control" id="mname" required>
                </div>
              </div>
                <div class="row">
                <div class="form-group col-md-6">
                  <label for="name">Last Name</label>
                  <input type="text" name="name" class="form-control" id="lname" required>
                </div>
                <div class="form-group col-md-6 mt-3 mt-md-0">
                  <label for="name">Name Extension</label>
                  <input type="text" class="form-control" id="next" >
                </div>
              </div>
              <div class="form-group mt-3">
                 <label for="name">College</label>
                  <input type="text" name="name" class="form-control" id="coll" readonly>
              </div>

                <div class="form-group mt-3">
                 <label for="name">Department</label>
                  <input type="text" name="name" class="form-control" id="dep" readonly>
              </div>


                <div class="form-group mt-3">
                 <label for="name">Program</label>
                  <input type="text" name="name" class="form-control" id="prog" readonly>
              </div>

                   
           <table>
              <thead>
                <tr>
                  <td>
                          <div class="text-center"><button id = "submitupdate" type="submit">Update</button></div>

                  </td>

                </tr>

              </thead>
           </table>
             
            
            </form>


          </div>

        </div>

      </div>
    </section>

  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer">
    <div class="container">
    
      <div class="social-links">
        <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
        <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
        <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
        <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
        <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
      </div>
      <div class="copyright">
         Logged in as:  <strong><span id = "curruser"></span></strong><br><br>
        &copy; Copyright <strong><span>ESSU Can-avid</span></strong>. All Rights Reserved
      </div>
      <div class="credits">
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/green-free-one-page-bootstrap-template/ -->
        Developed by:<a href="#">BSIT STUDENTS,2022</a>
      </div>
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

 <script src="bower_components/jquery/dist/jquery.min.js"></script>
<!-- Bootstrap 3.3.7 -->
<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="bower_components/jquery-ui/jquery-ui.min.js"></script>
<!-- Slimscroll -->
<script src="bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<!-- FastClick -->
<script src="bower_components/fastclick/lib/fastclick.js"></script>
<!-- AdminLTE App -->
<script src="dist/js/adminlte.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="dist/js/demo.js"></script>
<!-- fullCalendar -->
<script src="bower_components/moment/moment.js"></script>
<script src="bower_components/fullcalendar/dist/fullcalendar.min.js"></script>
<!-- Page specific script -->
<script>
  $(function () {


                  function phoneMask() { 
                                  var num = $(this).val().replace(/\D/g,''); 
                                  $(this).val(num.substring(0,1) + num.substring(1,2) +'-' + num.substring(2,3)+ num.substring(3,4)+ num.substring(4,5)+ num.substring(5,6)+ num.substring(6,7)); 
                                  }
                  
                                      $("#sn").keyup(phoneMask);


                  function checkifloggedin(){

                      let x = decodeURIComponent(document.cookie);

                      if(x == "as"){


                        window.location="index.html"
                      }


                      else{

                         getcurrentuser(x);

                      }


                       



                  }


                 


                        function getcurrentuser(a){
                  

                                        $.ajax({
                                          type: "POST",
                                          url: "php/retrievecurrentuser.php",
                                          dataType: "json",
                                            data: {
                                              a:a, 
                                             
                                             
                                         
                                            },
                                          success: function(result){
                                            var _res = result;
                                            if(_res.status == 1){
                                          
                                             $("#curruser").text(_res.a1);
                                             forupdate(_res.a1);
                                            
                                      
                                          
                                             
                                            } 
                                          }
                                        });}



                          $("#submitupdate").click(function(){
                           
                          a= $("#sn").val();
                          b= $("#fname").val();
                          c= $("#mname").val();
                          d= $("#lname").val();
                          e= $("#next").val();
                          f = b+ " " + c + " " + d + " " + e
                          g= $("#coll").val();
                          h= $("#dep").val();
                          i= $("#prog").val();



                                        if (a.length > 0 && b.length > 0 ){
                                            updatestudent(a,b,c,d,e,f,g,h,i);
                                                
                                              }
                                      
                                        else {

                                              alert("Please complete missing fields!")
                                              }
          
                                  
                                  });



      function updatestudent(a,b,c,d,e,f,g,h,i){

                  $.ajax({
                  type: "POST",
                  url: "php/update_student.php",
                  dataType: "json",
                  data: {
                      a:a,
                      b:b,
                      c:c,
                      d:d,
                      e:e,
                      f:f,
                      g:g,
                      h:h,
                      i:i,
                  
                            },
                        
                            success: function(result) {
                            var _res = result;
                              if (_res.status == 1){
                                      alert("Successfully updated!");
                                      window.location="updatestudents.html"
                           
                              } else if(_res.status == 2){
                                   alert("Update Failed!");
                                       
                                   
                          
                           
                              }
                              
                            }
                          
                             

                          });
                        }


    function loadstudents(){
      

                        $("#allrecords").find("tr.re-list").remove();
                        $.ajax({
                          type: "POST",
                          url: "php/students.php",
                          dataType: "json",
                          data: {
                           
                            
                          },
                          success: function(result){
                            if(typeof(result.status) === 'undefined')
                              $.each(result, function(val, key) {
                                $("#allrecords tr:last").after("<tr class='re-list'>" + 
                                  "<td><input type='radio' name='chosen' value='" + key.studnum + "' /></td>" +
                                       "<td>" + key.studnum+ "</td>" +
                                       "<td>" + key.fullname+ "</td>" +  
                                     
                                       
                                  

                                  "<td></td></tr>");




                              });
                              var rows = $('#allrecords').find('tr').length;
                              if(rows == 1)
                                $("#allrecords tr:last").after("<tr class='re-list'><td colspan='2'>No record to display.</td></tr>");
                      
                          }

                        });
    }




      $("#delete").click(function(){

                          var studnum = $('input[name=chosen]:checked').val();
     
                          var res = confirm("Are you sure you want to remove this student?");
                          if(res == true){
                          deletestudent(studnum);
      
        }
      
    });



            function deletestudent(id){
              var type= "student";

                              $.ajax({
                                type: "POST",
                                url: "php/delete.php",
                                dataType: "json",
                                data: {
                                  id: id,
                                  type:type,
                                },
                                success: function(result){
                                  if (result.status == 1) {
                                    alert("Selection deleted successfully.");
                                    window.location = "updatestudents.html";
                              
                               
                                  } else {
                                    alert("ERROR deleting data. Please try again.");
                                  }
                                }
                              });

                                  }


 $("#allrecords").click(function(){
  
                         var studnum = $('input[name=chosen]:checked').val();
                        forstudentupdate(studnum);
     
      
    });



 


         $("#search").on("input", function(){
                            var ab = $("#search").val();
                           
                            filterstudents(ab);

                                });



                function filterstudents(a){
                        $("#allrecords").find("tr.re-list").remove();
                        $.ajax({
                          type: "POST",
                          url: "php/filterstudents.php",
                          dataType: "json",
                          data: {
                           
                           a:a,
                            
                          },
                          success: function(result){
                            if(typeof(result.status) === 'undefined')
                              $.each(result, function(val, key) {
                                $("#allrecords tr:last").after("<tr class='re-list'>" + 
                                  "<td><input type='radio' name='chosen' value='" + key.studnum + "' /></td>" +
                                       "<td>" + key.studnum+ "</td>" +
                                       "<td>" + key.fullname+ "</td>" +  
                                    
                                  

                                  "<td></td></tr>");




                              });
                              var rows = $('#allrecords').find('tr').length;
                              if(rows == 1)
                                $("#allrecords tr:last").after("<tr class='re-list'><td colspan='2'>No record to display.</td></tr>");
                      
                          }

                        });
    }






                  function forupdate(a){
    

                          $.ajax({
                            type: "POST",
                            url: "php/retrieve_for_update.php",
                            dataType: "json",
                              data: {
                                a:a, 
                               
                               
                           
                              },
                            success: function(result){
                              var _res = result;
                              if(_res.status == 1){
                            
                               $("#sn").val(_res.a1);

                               forstudentupdate(_res.a1)
                         
                            
                               
                              } 
                            }
                          });}


                    function forstudentupdate(a){
    

                          $.ajax({
                            type: "POST",
                            url: "php/retrieve_student_data.php",
                            dataType: "json",
                              data: {
                                a:a, 
                               
                               
                           
                              },
                            success: function(result){
                              var _res = result;
                              if(_res.status == 1){
                            
                               $("#sn").val(_res.a1);
                                $("#fname").val(_res.a2);
                                 $("#mname").val(_res.a3);
                                  $("#lname").val(_res.a4);
                                   $("#next").val(_res.a5);
                                   $("#coll").val(_res.a6);
                                   $("#dep").val(_res.a7);
                                   $("#prog").val(_res.a8);
                         
                            
                               
                              } 
                            }
                          });}





          
            $(window).on("load",loadstudents()); 
            $(window).on("load",checkifloggedin()); 


  })
</script>

</html>